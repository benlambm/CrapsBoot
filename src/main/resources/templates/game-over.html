<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Game Over - Craps</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link th:href="@{/css/casino.css}" rel="stylesheet">
    <style>body { background-color: #1a1a1a; color: white; }</style>
</head>
<body class="container py-5 text-center d-flex flex-column justify-content-center align-items-center" style="min-height: 100vh;">

    <!-- Mute Toggle -->
    <div class="position-fixed top-0 end-0 p-3" style="z-index: 1000;">
        <button id="mute-toggle" class="btn btn-dark btn-sm fs-4 border-0" title="Toggle Sound" style="opacity: 0.7;"></button>
    </div>

    <h1 class="display-3 text-danger fw-bold mb-4 slam-in">GAME OVER</h1>

    <div class="card bg-dark text-white border-warning p-5 shadow-lg w-100 fade-in delay-2" style="max-width: 500px;">
        <h2 class="mb-3">Final Bankroll: $<span th:text="${score}" class="text-success"></span></h2>
        <h4 class="mb-4 text-secondary">Total Wins: <span th:text="${wins}"></span></h4>

        <!-- Achievements Section -->
        <div class="mb-4" th:if="${not achievements.isEmpty()}">
            <h5 class="text-warning">Achievements Unlocked</h5>
            <div class="d-flex flex-column gap-2 align-items-center">
                <div th:each="ach : ${achievements}" class="d-flex align-items-center gap-2 text-start">
                    <span class="fs-3" th:text="${ach.icon}"></span>
                    <div>
                        <strong th:text="${ach.displayName}"></strong>
                        <br><small class="text-muted" th:text="${ach.description}"></small>
                    </div>
                </div>
            </div>
        </div>
        <div class="mb-4 text-muted" th:if="${achievements.isEmpty()}">
            <small>No achievements unlocked this session. Try harder next time!</small>
        </div>

        <form th:action="@{/save-score}" method="post">
            <div class="mb-4">
                <label for="playerName" class="form-label fs-5">Enter your name for the Leaderboard</label>
                <input type="text" class="form-control form-control-lg text-center" id="playerName" name="playerName" required maxlength="20" placeholder="e.g. HighRoller99">
            </div>
            <button type="submit" class="btn btn-warning btn-lg w-100 fw-bold">Save Score & View Leaderboard</button>
        </form>

        <div class="mt-4">
            <a th:href="@{/}" class="text-decoration-none text-light">Or skip and play again</a>
        </div>
    </div>

    <script th:src="@{/js/casino.js}"></script>
</body>
</html>
